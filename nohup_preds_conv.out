Not creating /home/ranai/nuscenes_dataset/3D_Detection/saved_cms/lidar/full/model_01-08-2024_13_00 because it already exists
======
Loading NuScenes tables for version v1.0-trainval...
23 category,
8 attribute,
4 visibility,
64386 instance,
12 sensor,
10200 calibrated_sensor,
2631083 ego_pose,
68 log,
850 scene,
34149 sample,
2631083 sample_data,
1166187 sample_annotation,
4 map,
Done loading in 28.273 seconds.
======
Reverse indexing ...
Done reverse indexing in 6.5 seconds.
======
Read results count:  1000
Read results count:  2000
Read results count:  3000
Read results count:  4000
Read results count:  5000
Read results count:  6000
Read results count:  7000
Read results count:  8000
Read results count:  9000
Read results count:  10000
Read results count:  11000
Read results count:  12000
Read results count:  13000
Read results count:  14000
Read results count:  15000
Read results count:  16000
Read results count:  17000
Read results count:  18000
Read results count:  19000
Read results count:  20000
Read results count:  21000
Read results count:  22000
Read results count:  23000
Read results count:  24000
Read results count:  25000
Read results count:  26000
Read results count:  27000
Read results count:  28000
Read results count:  29000
Read results count:  30000
Read results count:  31000
Read results count:  32000
Read results count:  33000
Read results count:  34000
  0%|          | 0/6019 [00:00<?, ?it/s]  3%|▎         | 175/6019 [00:00<00:03, 1744.85it/s]  6%|▌         | 350/6019 [00:00<00:07, 716.07it/s]   8%|▊         | 452/6019 [00:00<00:07, 780.17it/s]  9%|▉         | 551/6019 [00:00<00:07, 756.78it/s] 11%|█         | 649/6019 [00:00<00:06, 812.33it/s] 12%|█▏        | 741/6019 [00:00<00:07, 726.71it/s] 14%|█▎        | 821/6019 [00:01<00:07, 697.36it/s] 15%|█▍        | 896/6019 [00:01<00:08, 625.96it/s] 16%|█▌        | 963/6019 [00:01<00:08, 610.20it/s] 17%|█▋        | 1027/6019 [00:01<00:09, 527.34it/s] 18%|█▊        | 1083/6019 [00:01<00:10, 473.34it/s] 19%|█▉        | 1138/6019 [00:01<00:09, 489.84it/s] 20%|█▉        | 1189/6019 [00:01<00:09, 487.99it/s] 22%|██▏       | 1306/6019 [00:01<00:07, 661.44it/s] 23%|██▎       | 1382/6019 [00:02<00:06, 685.18it/s] 25%|██▌       | 1517/6019 [00:02<00:05, 866.02it/s] 27%|██▋       | 1608/6019 [00:02<00:07, 597.72it/s] 28%|██▊       | 1682/6019 [00:02<00:07, 595.13it/s] 29%|██▉       | 1761/6019 [00:02<00:06, 638.52it/s] 30%|███       | 1833/6019 [00:02<00:06, 648.27it/s] 32%|███▏      | 1904/6019 [00:02<00:07, 586.06it/s] 33%|███▎      | 1968/6019 [00:03<00:07, 559.99it/s] 34%|███▎      | 2030/6019 [00:03<00:06, 573.29it/s] 35%|███▍      | 2090/6019 [00:03<00:07, 560.70it/s] 36%|███▌      | 2148/6019 [00:03<00:07, 547.67it/s] 37%|███▋      | 2204/6019 [00:03<00:07, 495.53it/s] 38%|███▊      | 2279/6019 [00:03<00:06, 559.23it/s] 39%|███▉      | 2337/6019 [00:03<00:06, 536.14it/s] 40%|███▉      | 2393/6019 [00:03<00:07, 502.83it/s] 41%|████▏     | 2496/6019 [00:03<00:05, 638.52it/s] 43%|████▎     | 2580/6019 [00:04<00:04, 691.99it/s] 44%|████▍     | 2652/6019 [00:04<00:05, 633.82it/s] 45%|████▌     | 2718/6019 [00:04<00:05, 597.07it/s] 46%|████▌     | 2780/6019 [00:04<00:05, 580.95it/s] 47%|████▋     | 2851/6019 [00:04<00:05, 614.20it/s] 49%|████▊     | 2933/6019 [00:04<00:04, 668.98it/s] 51%|█████     | 3042/6019 [00:04<00:03, 786.47it/s] 52%|█████▏    | 3123/6019 [00:04<00:04, 691.53it/s] 53%|█████▎    | 3198/6019 [00:05<00:04, 705.10it/s] 54%|█████▍    | 3271/6019 [00:05<00:04, 686.81it/s] 56%|█████▌    | 3343/6019 [00:05<00:03, 694.35it/s] 57%|█████▋    | 3424/6019 [00:05<00:03, 726.29it/s] 58%|█████▊    | 3512/6019 [00:05<00:03, 769.42it/s] 60%|█████▉    | 3594/6019 [00:05<00:03, 782.84it/s] 61%|██████    | 3674/6019 [00:05<00:03, 780.73it/s] 62%|██████▏   | 3753/6019 [00:05<00:03, 752.80it/s] 65%|██████▌   | 3916/6019 [00:05<00:02, 1003.43it/s] 67%|██████▋   | 4029/6019 [00:05<00:01, 1034.92it/s] 69%|██████▊   | 4134/6019 [00:06<00:02, 904.19it/s]  71%|███████   | 4247/6019 [00:06<00:01, 962.68it/s] 72%|███████▏  | 4347/6019 [00:06<00:01, 850.85it/s] 74%|███████▎  | 4437/6019 [00:06<00:02, 703.63it/s] 75%|███████▍  | 4514/6019 [00:06<00:02, 654.31it/s] 78%|███████▊  | 4708/6019 [00:06<00:01, 949.55it/s] 82%|████████▏ | 4909/6019 [00:06<00:00, 1211.24it/s] 84%|████████▍ | 5045/6019 [00:07<00:00, 1187.74it/s] 86%|████████▌ | 5174/6019 [00:07<00:00, 1053.33it/s] 88%|████████▊ | 5289/6019 [00:07<00:00, 942.65it/s]  90%|████████▉ | 5391/6019 [00:07<00:00, 828.35it/s] 95%|█████████▌| 5745/6019 [00:07<00:00, 1434.86it/s]100%|█████████▉| 6003/6019 [00:07<00:00, 1710.59it/s]                                                     The predictions of NuScenes have been saved to /home/ranai/nuscenes_dataset/inference_results/model_01-08-2024_13_00/results_nusc.json
 Ln279: get_metrics called on /home/ranai/nuscenes_dataset/inference_results/model_01-08-2024_13_00/results_nusc.json with v1.0-trainval and val
Initializing nuScenes detection evaluation
Loaded results from /home/ranai/nuscenes_dataset/inference_results/model_01-08-2024_13_00/results_nusc.json. Found detections for 6014 samples.
Loading annotations for val split from nuScenes version: v1.0-trainval
  0%|          | 0/6019 [00:00<?, ?it/s]  3%|▎         | 177/6019 [00:00<00:03, 1762.45it/s]  6%|▌         | 354/6019 [00:00<00:07, 782.55it/s]   8%|▊         | 467/6019 [00:00<00:06, 876.38it/s] 10%|▉         | 576/6019 [00:00<00:06, 851.18it/s] 11%|█         | 674/6019 [00:00<00:06, 826.89it/s] 13%|█▎        | 765/6019 [00:00<00:06, 799.26it/s] 14%|█▍        | 850/6019 [00:01<00:07, 697.29it/s] 15%|█▌        | 924/6019 [00:01<00:08, 627.48it/s] 16%|█▋        | 990/6019 [00:01<00:08, 587.36it/s] 17%|█▋        | 1051/6019 [00:01<00:10, 472.44it/s] 18%|█▊        | 1105/6019 [00:01<00:10, 486.67it/s] 19%|█▉        | 1161/6019 [00:01<00:09, 502.62it/s] 20%|██        | 1223/6019 [00:01<00:09, 531.00it/s] 22%|██▏       | 1331/6019 [00:01<00:06, 674.13it/s] 24%|██▍       | 1442/6019 [00:02<00:05, 792.46it/s] 25%|██▌       | 1526/6019 [00:02<00:05, 788.04it/s] 27%|██▋       | 1608/6019 [00:02<00:07, 576.26it/s] 28%|██▊       | 1676/6019 [00:02<00:07, 573.09it/s] 29%|██▉       | 1755/6019 [00:02<00:06, 623.37it/s] 30%|███       | 1828/6019 [00:02<00:06, 647.93it/s] 32%|███▏      | 1898/6019 [00:02<00:07, 580.56it/s] 33%|███▎      | 1961/6019 [00:03<00:07, 531.37it/s] 34%|███▎      | 2021/6019 [00:03<00:07, 547.62it/s] 35%|███▍      | 2079/6019 [00:03<00:07, 534.15it/s] 35%|███▌      | 2135/6019 [00:03<00:07, 539.78it/s] 36%|███▋      | 2191/6019 [00:03<00:07, 500.33it/s] 38%|███▊      | 2265/6019 [00:03<00:06, 562.13it/s] 39%|███▊      | 2324/6019 [00:03<00:06, 543.74it/s] 40%|███▉      | 2380/6019 [00:03<00:06, 527.36it/s] 41%|████▏     | 2487/6019 [00:03<00:05, 672.72it/s] 43%|████▎     | 2579/6019 [00:04<00:04, 739.63it/s] 44%|████▍     | 2655/6019 [00:04<00:05, 663.48it/s] 45%|████▌     | 2725/6019 [00:04<00:05, 626.34it/s] 46%|████▋     | 2790/6019 [00:04<00:05, 606.14it/s] 48%|████▊     | 2865/6019 [00:04<00:04, 641.67it/s] 49%|████▉     | 2940/6019 [00:04<00:04, 665.46it/s] 51%|█████     | 3064/6019 [00:04<00:03, 824.43it/s] 52%|█████▏    | 3149/6019 [00:04<00:04, 658.31it/s] 54%|█████▎    | 3230/6019 [00:04<00:04, 693.06it/s] 55%|█████▍    | 3309/6019 [00:05<00:03, 715.98it/s] 56%|█████▌    | 3385/6019 [00:05<00:03, 696.94it/s] 58%|█████▊    | 3484/6019 [00:05<00:03, 773.63it/s] 59%|█████▉    | 3565/6019 [00:05<00:03, 778.63it/s] 61%|██████    | 3645/6019 [00:05<00:03, 775.50it/s] 62%|██████▏   | 3724/6019 [00:05<00:03, 746.09it/s] 64%|██████▍   | 3852/6019 [00:05<00:02, 893.93it/s] 66%|██████▋   | 4002/6019 [00:05<00:01, 1063.39it/s] 68%|██████▊   | 4111/6019 [00:06<00:02, 883.28it/s]  70%|██████▉   | 4206/6019 [00:06<00:02, 890.89it/s] 71%|███████▏  | 4300/6019 [00:06<00:02, 808.40it/s] 73%|███████▎  | 4386/6019 [00:06<00:02, 728.28it/s] 74%|███████▍  | 4463/6019 [00:06<00:02, 680.87it/s] 75%|███████▌  | 4534/6019 [00:06<00:02, 614.44it/s] 80%|███████▉  | 4791/6019 [00:06<00:01, 1074.66it/s] 82%|████████▏ | 4945/6019 [00:06<00:00, 1186.79it/s] 84%|████████▍ | 5076/6019 [00:07<00:00, 1189.57it/s] 86%|████████▋ | 5204/6019 [00:07<00:00, 1010.42it/s] 88%|████████▊ | 5316/6019 [00:07<00:00, 949.54it/s]  90%|█████████ | 5419/6019 [00:07<00:00, 860.18it/s] 97%|█████████▋| 5828/6019 [00:07<00:00, 1614.68it/s]100%|██████████| 6019/6019 [00:07<00:00, 785.66it/s] 
Loaded ground truth annotations for 6019 samples.
 ---- nusc/eval/detection/eval.py Ln 84: len_pred_boxes = 6014, len_gt_boxes = 6019
Traceback (most recent call last):
  File "preds_to_nusc_converter.py", line 309, in <module>
    metrics, metrics_summary, obj = get_metrics(output_path, res_path)
  File "preds_to_nusc_converter.py", line 281, in get_metrics
    nusc_eval = NuScenesEval(
  File "/home/ranai/software/miniconda3/envs/detection/lib/python3.8/site-packages/nuscenes/eval/detection/evaluate.py", line 85, in __init__
    assert set(self.pred_boxes.sample_tokens) == set(self.gt_boxes.sample_tokens), \
AssertionError: Samples in split doesn't match samples in predictions.
